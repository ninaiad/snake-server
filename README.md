# Snake-server

Серверная часть веб-приложения игры Змейка, обрабатывает HTTP запросы клиентской части и работает с СУБД PostgreSQL.

## Docker compose

Так как серверная часть веб-приложения состоит из двух сущностей, независимых друг от друга, но взаимодействующих во время его работы – приложения на Go, взаимодействующей с системой управления баз данных (СУБД), и самой CУБД, было решено использовать инструмент Docker compose для упрощения и унификации запуска всей системы. Такое решение является стандартным для данной задачи. 

Для приложения на Go написан отдельный образ (docker image), который автоматически запускается после запуска и инициализации образа СУБД PostgreSQL. 
Так как PostgreSQL всегда запускается с задержкой и подключиться к нему сразу не получится, в файле docker-compose.yml, описывающем процесс сборки и запуска приложения, перед запуском контейнера сервера работает скрипт	`wait-for-postgres.sh`, который ждет пока СУБД будет готова к работе. Чтобы содержимое базы данных, с которой работает приложение, оставалось неизменным при пересборке, оно на диске по указанному адресу в метке volumes файла docker-compose.yml.


## REST API

Для того чтобы гарантировать возможности расширять, модифицировать, тестировать и документировать проект для его выполнения необходимо было выбрать архитектуру. В качестве архитектуры серверной части приложения, был выбран REST. Representational State Transfer (REST) — это программная архитектура, которая определяет условия работы API. Архитектуру на основе REST можно использовать для поддержки высокопроизводительной и надежной связи в требуемом масштабе. Ее можно легко внедрять и изменять, обеспечивая прозрачность и кроссплатформенную переносимость любой системы API.
Для построения RESTful приложения необходимо было удовлетворить обязательным требованиям:
1. Приложение должно иметь модель клиент-сервер.
2. Отсутствие состояния. В период между запросами клиента никакая информация о его *состоянии*не хранится на сервере. В каждом отдельном запросе передается необходимое и достаточное количество информации для его выполнения.
3. Ответы сервера могут быть кэшированы.
4. Единый интерфейс, который накладывает следующие ограничения:
	* Запросы должны идентифицировать ресурсы. Это происходит за счет единого идентификатора ресурсов.
	* Если у клиента хранится представление ресурса, включая его метаданные, то он обладает достаточной информацией для модификации или удаления этого ресурса.
	* Каждое сообщение содержит достаточно информации, чтобы понять, каким образом его обрабатывать.
	* Клиенты изменяют состояние системы только через действия, которые динамически определены в гипермедиа на сервере, и им не нужно знать заранее типы ресурсов и механизмы взаимодействия с ними. Понимание новых типов ресурсов приобретается в режиме реального времени.
5. Многоуровневость системы. Клиент обычно не способен точно определить, взаимодействует ли он напрямую с сервером или же с промежуточным узлом. Такой подход позволяет разделить ответственность и повысить масштабируемость и безопасность системы.

## Структура программы

Программа запускается из файла `cmd/main.go`. Каждый отдельный сервер, обрабатывающих HTTP запросы, запускается методом Run (см. файл `http-server.go`). Структуры информации, хранящие данные пользователей, которые являются общими для всех компонент приложения можно найти в `user.go`.

Серверная часть веб-приложения разделена на три основных части: 
1. Handler, обрабатывающая HTTP запросы клиента;
2. Service, на уровне которого реализуется логика обработки данных и работа с аутентификацией;
3. уровень Database, работающий с СУБД.

Подробнее о каждой из них можно почитать в `README.md` в соответствующих им директориях:
* pkg/handler
* pkg/service
* pkg/database
